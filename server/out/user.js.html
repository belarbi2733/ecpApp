<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: user.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: user.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
var db = require("../config/config.js");
/**
*User module that contain all SQL request that are relative to the user table
*@module
*/
let Utilisateur = {
    /**
    *@method getUtilisateur
    *@desc request that select informations from the database about a user according to his mail
    *@param {string} mail
    */
    getUtilisateur: function(utilisateur, callback)
    {
      return db.query('SELECT * FROM utilisateur WHERE mail = $1', [utilisateur.body.mail],callback);
    },
    /**
    *@method getIdUtilisateurByMail
    *@desc request that select id of a user from the database according to his mail
    *@param {string}mail
    */
    getIdUtilisateurByMail: function(mail, callback)
    {
      return db.query('SELECT id FROM utilisateur WHERE mail = $1', [mail], callback);
    },
    /**
    *@method addPosition
    *@desc update user's location in the database
    *@param {string}lat
    *@param {string}long
    *@param {number}idUser id of the user
    */
    addPosition: function(utilisateur, callback){
      return db.query('UPDATE utilisateur SET position_lat = $1, position_long = $2 WHERE id = $3', [utilisateur.query['lat'], utilisateur.query['long'], utilisateur.query['idUser']], callback);
    },
    /**
    *@method getDriver
    *@desc select id of the driver of a round
    *@param {number}idTour id of the round
    */
    getDriver: function(idTour, callback){
      return db.query('select id_user from voiture where id = (select id_voiture from tournee where id = $1)',[idTour], callback);
    },
    /**
    *@method getPosition
    *@desc select location of a user
    *@param {number}id id of the user
    */
    getPosition: function(id, callback){
      return db.query('Select position_lat, position_long, prenom from utilisateur where id = $1', [id], callback);
    },
    /**
    *@method getDataById
    *@desc select informations of a user according to his id
    *@param{number}id id of the user
    */
    getDataById: function(id, callback){
      return db.query('Select * from utilisateur where id = $1', [id], callback);
    },
    /**
    *@method updateUtilisateur
    *@desc update user table with new average rating, new ratings number according to the user id
    *@param{number}avr_rating
    *@param{number}nbr_ratings
    *@param{number}id id of the user
    */
    updateUtilisateur: function(utilisateur, callback){
      return db.query('UPDATE utilisateur SET avr_rating = $1, nbr_ratings= $2 WHERE id = $3', [utilisateur.avr_rating,utilisateur.nbr_ratings, utilisateur.id], callback);
    }
};

module.exports = Utilisateur;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-car.html">car</a></li><li><a href="module-colis.html">colis</a></li><li><a href="module-tournee.html">tournee</a></li><li><a href="module-trajet.html">trajet</a></li><li><a href="module-user.html">user</a></li></ul><h3>Global</h3><ul><li><a href="global.html#app">app</a></li><li><a href="global.html#checkCode">checkCode</a></li><li><a href="global.html#colis">colis</a></li><li><a href="global.html#colisonly">colisonly</a></li><li><a href="global.html#comment">comment</a></li><li><a href="global.html#getCode">getCode</a></li><li><a href="global.html#getDriver">getDriver</a></li><li><a href="global.html#getIdCar">getIdCar</a></li><li><a href="global.html#getPosition">getPosition</a></li><li><a href="global.html#getUserId">getUserId</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#position">position</a></li><li><a href="global.html#rating">rating</a></li><li><a href="global.html#tournee">tournee</a></li><li><a href="global.html#trajet">trajet</a></li><li><a href="global.html#trajetAll">trajetAll</a></li><li><a href="global.html#trajetColis">trajetColis</a></li><li><a href="global.html#trajetConduct">trajetConduct</a></li><li><a href="global.html#validate">validate</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Sun Jan 05 2020 03:14:58 GMT+0100 (GMT+01:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
